<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>使用 awk 统计字母频率｜六开箱</title><meta name=keywords content="Linux,shell,bash,awk,frequency,字频统计,教程"><meta name=description content="编写一个 awk 脚本来找到一组单词中出现次数最多（和最少）的单词。"><meta name=author content="六开箱"><link rel=canonical href=https://lkxed.github.io/posts/gawk-letter-game/><link crossorigin=anonymous href=/assets/css/stylesheet.min.09b98575a0a9c52a0dcff6660328188f9365049be8c47253f3072a85d10d82a5.css integrity="sha256-CbmFdaCpxSoNz/ZmAygYj5NlBJvoxHJT8wcqhdENgqU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://lkxed.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://lkxed.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://lkxed.github.io/favicon-32x32.png><link rel=manifest href=https://lkxed.github.io/site.webmanifest><link rel=apple-touch-icon href=https://lkxed.github.io/apple-touch-icon.png><link rel=mask-icon href=https://lkxed.github.io/safari-pinned-tab.svg><meta name=theme-color content="#f5f5f5" media="(prefers-color-scheme: light)"><meta name=theme-color content="#1d1e20" media="(prefers-color-scheme: dark)"><meta name=msapplication-TileColor content="#ffffff"><noscript><style>.top-link{display:none}</style></noscript><meta name=shenma-site-verification content="0834e815906a93375245a759f409f8b0_1648880760"><meta name=baidu-site-verification content="code-2I1Hg4GETM"><meta name=google-site-verification content="xBkkt93v_nso_R-2aQ-An4rbc_Gi_4rNFi8oBEKDNjc"><meta property="og:title" content="使用 awk 统计字母频率"><meta property="og:description" content="编写一个 awk 脚本来找到一组单词中出现次数最多（和最少）的单词。"><meta property="og:type" content="article"><meta property="og:url" content="https://lkxed.github.io/posts/gawk-letter-game/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-20T08:51:36+08:00"><meta property="article:modified_time" content="2022-03-20T08:51:36+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="使用 awk 统计字母频率"><meta name=twitter:description content="编写一个 awk 脚本来找到一组单词中出现次数最多（和最少）的单词。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"文章","item":"https://lkxed.github.io/posts/"},{"@type":"ListItem","position":2,"name":"使用 awk 统计字母频率","item":"https://lkxed.github.io/posts/gawk-letter-game/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用 awk 统计字母频率","name":"使用 awk 统计字母频率","description":"编写一个 awk 脚本来找到一组单词中出现次数最多（和最少）的单词。","keywords":["Linux","shell","bash","awk","frequency","字频统计","教程"],"articleBody":" 编写一个 awk 脚本来找到一组单词中出现次数最多（和最少）的单词。\n 前言 近一段时间，我开始编写一个小游戏，在这个小游戏里，玩家使用一个个字母块来组成单词。编写这个游戏之前，我需要先知道常见英文单词中每个字母的使用频率，这样一来，我就可以找到一组更有用的字母块。字母频次统计在很多地方都有相关讨论，包括在 维基百科 上，但我还是想要自己来实现。\nLinux 系统在 /usr/share/dict/words 文件中提供了一个单词列表，所以我已经有了一个现成的单词列表。然而，尽管这个 words 文件包含了很多我想要的单词，却也包含了一些我不想要的。我想要的单词首先不能是复合词（即不包含连接符和空格的单词），也不能是专有名词（即不包含大写字母单词）。为了得到这个结果，我可以运行 grep 命令来取出只由小写字母组成的行：\n$ grep '^[a-z]*$' /usr/share/dict/words 这个正则表达式的作用是让 grep 去匹配仅包含小写字母的行。表达式中的字符 ^ 和 $ 分别代表了这一行的开始和结束。[a-z] 分组仅匹配从 “a” 到 “z” 的小写字母。\n下面是一个输出示例：\n$ grep '^[a-z]*$' /usr/share/dict/words | head a aa aaa aah aahed aahing aahs aal aalii aaliis 没错，这些都是合法的单词。比如，“aahed” 是 “aah” 的过去式，表示在放松时的感叹，而 “aalii” 是一种浓密的热带灌木。\n现在我只需要编写一个 gawk 脚本来统计出单词中各个字母出现的次数，然后打印出每个字母的相对频率。\n字母计数 一种使用 gawk 来统计字母个数的方式是，遍历每行输入中的每一个字符，然后对 “a” 到 “z” 之间的每个字母进行计数。substr 函数会返回一个给定长度的子串，它可以只包含一个字符，也可以是更长的字符串。比如，下面的示例代码能够取到输入中的每一个字符 c：\n{ len = length($0); for (i = 1; i = len; i++) { c = substr($0, i, 1); } } 如果使用一个全局字符串变量 LETTERS 来存储字母表，我就可以借助 index 函数来找到某个字符在字母表中的位置。我将扩展 gawk 代码示例，让它在输入数据中只取范围在 “a” 到 “z” 的字母：\nBEGIN { LETTERS = \"abcdefghijklmnopqrstuvwxyz\" } { len = length($0); for (i = 1; i = len; i++) { c = substr($0, i, 1); ltr = index(LETTERS, c); } } 需要注意的是，index 函数将返回字母在 LETTERS 字符串中首次出现的位置，第一个位置返回 1，如果没有找到则返回 0。如果我有一个大小为 26 的数组，我就可以利用这个数组来统计每个字母出现的次数。我将在下面的示例代码中添加这个功能，每当一个字母出现在输入中，我就让它对应的数组元素值增加 1（使用 ++）：\nBEGIN { LETTERS = \"abcdefghijklmnopqrstuvwxyz\" } { len = length($0); for (i = 1; i = len; i++) { c = substr($0, i, 1); ltr = index(LETTERS, c); if (ltr \u0026gt; 0) { ++count[ltr]; } } } 打印相对频率 当 gawk 脚本统计完所有的字母后，我希望它能输出每个字母的频率。毕竟，我对输入中各个字母的个数没有兴趣，我更关心它们的 相对频率。\n我将先统计字母 “a” 的个数，然后把它和剩余 “b” 到 “z” 字母的个数比较：\nEND { min = count[1]; for (ltr = 2; ltr = 26; ltr++) { if (count[ltr] ) { min = count[ltr]; } } } 在循环的最后，变量 min 会等于最少的出现次数，我可以把它为基准，为字母的个数设定一个参照值，然后计算打印出每个字母的相对频率。比如，如果出现次数最少的字母是 “q”，那么 min 就会等于 “q” 的出现次数。\n接下来，我会遍历每个字母，打印出它和它的相对频率。我通过把每个字母的个数都除以 min 的方式来计算出它的相对频率，这意味着出现次数最少的字母的相对频率是 1。如果另一个字母出现的次数恰好是最少次数的两倍，那么这个字母的相对频率就是 2。我只关心整数，所以 2.1 和 2.9 对我来说是一样的（都是 2）。\nEND { min = count[1]; for (ltr = 2; ltr = 26; ltr++) { if (count[ltr] ) { min = count[ltr]; } } for (ltr = 1; ltr = 26; ltr++) { print substr(LETTERS, ltr, 1), int(count[ltr] / min); } } 最后的完整程序 现在，我已经有了一个能够统计输入中各个字母的相对频率的 gawk 脚本：\n#!/usr/bin/gawk -f  # 只统计 a-z 的字符，忽略 A-Z 和其他的字符 BEGIN { LETTERS = \"abcdefghijklmnopqrstuvwxyz\" } { len = length($0); for (i = 1; i = len; i++) { c = substr($0, i, 1); ltr = index(LETTERS, c); if (ltr ) { ++count[ltr]; } } } # 打印每个字符的相对频率 END { min = count[1]; for (ltr = 2; ltr = 26; ltr++) { if (count[ltr] ) { min = count[ltr]; } } for (ltr = 1; ltr = 26; ltr++) { print substr(LETTERS, ltr, 1), int(count[ltr] / min); } } 我将把这段程序保存到名为 letter-freq.awk 的文件中，这样一来，我就可以在命令行中更方便地使用它。\n如果你愿意的话，你也可以使用 chmod +x 命令把这个文件设为可独立执行。第一行中的 #!/usr/bin/gawk -f 表示 Linux 会使用 /usr/bin/gawk 把这个文件当作一个脚本来运行。由于 gawk 命令行使用 -f 来指定它要运行的脚本文件名，你需要在末尾加上 -f。如此一来，当你在 shell 中执行 letter-freq.awk，它会被解释为 /usr/bin/gawk -f letter-freq.awk。\n接下来我将用几个简单的输入来测试这个脚本。比如，如果我给我的 gawk 脚本输入整个字母表，每个字母的相对频率都应该是 1：\n$ echo abcdefghijklmnopqrstuvwxyz | gawk -f letter-freq.awk a 1 b 1 c 1 d 1 e 1 f 1 g 1 h 1 i 1 j 1 k 1 l 1 m 1 n 1 o 1 p 1 q 1 r 1 s 1 t 1 u 1 v 1 w 1 x 1 y 1 z 1 还是使用上述例子，只不过这次我在输入中添加了一个字母 “e”，此时的输出结果中，“e” 的相对频率会是 2，而其他字母的相对频率仍然会是 1：\n$ echo abcdeefghijklmnopqrstuvwxyz | gawk -f letter-freq.awk a 1 b 1 c 1 d 1 e 2 f 1 g 1 h 1 i 1 j 1 k 1 l 1 m 1 n 1 o 1 p 1 q 1 r 1 s 1 t 1 u 1 v 1 w 1 x 1 y 1 z 1 现在我可以跨出最大的一步了！我将使用 grep 命令和 /usr/share/dict/words 文件，统计所有仅由小写字母组成的单词中，各个字母的相对使用频率：\n$ grep '^[a-z]*$' /usr/share/dict/words | gawk -f letter-freq.awk a 53 b 12 c 28 d 21 e 72 f 7 g 15 h 17 i 58 j 1 k 5 l 36 m 19 n 47 o 47 p 21 q 1 r 46 s 48 t 44 u 25 v 6 w 4 x 1 y 13 z 2 在 /usr/share/dict/words 文件的所有小写单词中，字母 “j”、“q” 和 “x” 出现的相对频率最低，字母 “z” 也使用得很少。不出意料，字母 “e” 是使用频率最高的。\n  转载须知：本文遵循 CC BY-SA 4.0 许可协议 链接：https://lkxed.github.io/posts/gawk-letter-game/ 作者：Jim Hall / 译者：六开箱 原文：Use awk to calculate letter frequency 首发：使用 awk 统计字母频率 @ Linux 中国  ","wordCount":"2235","inLanguage":"zh","datePublished":"2022-03-20T08:51:36+08:00","dateModified":"2022-03-20T08:51:36+08:00","author":{"@type":"Person","name":"六开箱"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://lkxed.github.io/posts/gawk-letter-game/"},"publisher":{"@type":"Organization","name":"六开箱","logo":{"@type":"ImageObject","url":"https://lkxed.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://lkxed.github.io/ accesskey=h title="六开箱 (Alt + H)"><img src=https://lkxed.github.io/favicon.ico alt=logo aria-label=logo height=30>六开箱</a></div><ul id=menu><li><a href=https://lkxed.github.io/posts/ title=文章><span>文章</span></a></li><li><a href=https://lkxed.github.io/archives/ title=归档><span>归档</span></a></li><li><a href=https://lkxed.github.io/series/ title=系列><span>系列</span></a></li><li><a href=https://lkxed.github.io/tags/ title=标签><span>标签</span></a></li><li><a href=https://lkxed.github.io/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>使用 awk 统计字母频率</h1><div class=post-meta><span title="2022-03-20 08:51:36 +0800 CST">2022 年 3 月 20 日</span>&nbsp;·&nbsp;2235 字&nbsp;·&nbsp;六开箱&nbsp;｜&nbsp;<a href=https://github.com/lkxed/ rel="noopener noreferrer" target=_blank>关注我🌟</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e5%89%8d%e8%a8%80 aria-label=前言>前言</a><ul><li><a href=#%e5%ad%97%e6%af%8d%e8%ae%a1%e6%95%b0 aria-label=字母计数>字母计数</a></li><li><a href=#%e6%89%93%e5%8d%b0%e7%9b%b8%e5%af%b9%e9%a2%91%e7%8e%87 aria-label=打印相对频率>打印相对频率</a></li><li><a href=#%e6%9c%80%e5%90%8e%e7%9a%84%e5%ae%8c%e6%95%b4%e7%a8%8b%e5%ba%8f aria-label=最后的完整程序>最后的完整程序</a></li></ul></li></ul></div></details></div><div class=post-content><blockquote><p>编写一个 awk 脚本来找到一组单词中出现次数最多（和最少）的单词。</p></blockquote><p><img loading=lazy src=https://img.linux.net.cn/data/attachment/album/202203/20/085052bajyoejnea8cpw5j.jpg alt></p><h2 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h2><p>近一段时间，我开始编写一个小游戏，在这个小游戏里，玩家使用一个个字母块来组成单词。编写这个游戏之前，我需要先知道常见英文单词中每个字母的使用频率，这样一来，我就可以找到一组更有用的字母块。字母频次统计在很多地方都有相关讨论，包括在 <a href=https://en.wikipedia.org/wiki/Letter_frequency target=_blank rel="noopener noreferrer">维基百科</a>
上，但我还是想要自己来实现。</p><p>Linux 系统在 <code>/usr/share/dict/words</code> 文件中提供了一个单词列表，所以我已经有了一个现成的单词列表。然而，尽管这个 <code>words</code> 文件包含了很多我想要的单词，却也包含了一些我不想要的。我想要的单词首先不能是复合词（即不包含连接符和空格的单词），也不能是专有名词（即不包含大写字母单词）。为了得到这个结果，我可以运行 <code>grep</code> 命令来取出只由小写字母组成的行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ grep  <span class=s1>&#39;^[a-z]*$&#39;</span> /usr/share/dict/words
</span></span></code></pre></div><p>这个正则表达式的作用是让 <code>grep</code> 去匹配仅包含小写字母的行。表达式中的字符 <code>^</code> 和 <code>$</code> 分别代表了这一行的开始和结束。<code>[a-z]</code> 分组仅匹配从 “a” 到 “z” 的小写字母。</p><p>下面是一个输出示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ grep  <span class=s1>&#39;^[a-z]*$&#39;</span> /usr/share/dict/words <span class=p>|</span> head
</span></span><span class=line><span class=cl>a
</span></span><span class=line><span class=cl>aa
</span></span><span class=line><span class=cl>aaa
</span></span><span class=line><span class=cl>aah
</span></span><span class=line><span class=cl>aahed
</span></span><span class=line><span class=cl>aahing
</span></span><span class=line><span class=cl>aahs
</span></span><span class=line><span class=cl>aal
</span></span><span class=line><span class=cl>aalii
</span></span><span class=line><span class=cl>aaliis
</span></span></code></pre></div><p>没错，这些都是合法的单词。比如，“aahed” 是 “aah” 的过去式，表示在放松时的感叹，而 “aalii” 是一种浓密的热带灌木。</p><p>现在我只需要编写一个 <code>gawk</code> 脚本来统计出单词中各个字母出现的次数，然后打印出每个字母的相对频率。</p><h3 id=字母计数>字母计数<a hidden class=anchor aria-hidden=true href=#字母计数>#</a></h3><p>一种使用 <code>gawk</code> 来统计字母个数的方式是，遍历每行输入中的每一个字符，然后对 “a” 到 “z” 之间的每个字母进行计数。<code>substr</code> 函数会返回一个给定长度的子串，它可以只包含一个字符，也可以是更长的字符串。比如，下面的示例代码能够取到输入中的每一个字符 <code>c</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>len</span> <span class=o>=</span> length<span class=o>(</span><span class=nv>$0</span><span class=o>)</span><span class=p>;</span> <span class=k>for</span> <span class=o>(</span><span class=nv>i</span> <span class=o>=</span> 1<span class=p>;</span> i &lt;<span class=o>=</span> len<span class=p>;</span> i++<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>c</span> <span class=o>=</span> substr<span class=o>(</span><span class=nv>$0</span>, i, 1<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>如果使用一个全局字符串变量 <code>LETTERS</code> 来存储字母表，我就可以借助 <code>index</code> 函数来找到某个字符在字母表中的位置。我将扩展 <code>gawk</code> 代码示例，让它在输入数据中只取范围在 “a” 到 “z” 的字母：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>BEGIN <span class=o>{</span> <span class=nv>LETTERS</span> <span class=o>=</span> <span class=s2>&#34;abcdefghijklmnopqrstuvwxyz&#34;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>len</span> <span class=o>=</span> length<span class=o>(</span><span class=nv>$0</span><span class=o>)</span><span class=p>;</span> <span class=k>for</span> <span class=o>(</span><span class=nv>i</span> <span class=o>=</span> 1<span class=p>;</span> i &lt;<span class=o>=</span> len<span class=p>;</span> i++<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>c</span> <span class=o>=</span> substr<span class=o>(</span><span class=nv>$0</span>, i, 1<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>ltr</span> <span class=o>=</span> index<span class=o>(</span>LETTERS, c<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>需要注意的是，<code>index</code> 函数将返回字母在 <code>LETTERS</code> 字符串中首次出现的位置，第一个位置返回 1，如果没有找到则返回 0。如果我有一个大小为 26 的数组，我就可以利用这个数组来统计每个字母出现的次数。我将在下面的示例代码中添加这个功能，每当一个字母出现在输入中，我就让它对应的数组元素值增加 1（使用 <code>++</code>）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>BEGIN <span class=o>{</span> <span class=nv>LETTERS</span> <span class=o>=</span> <span class=s2>&#34;abcdefghijklmnopqrstuvwxyz&#34;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>len</span> <span class=o>=</span> length<span class=o>(</span><span class=nv>$0</span><span class=o>)</span><span class=p>;</span> <span class=k>for</span> <span class=o>(</span><span class=nv>i</span> <span class=o>=</span> 1<span class=p>;</span> i &lt;<span class=o>=</span> len<span class=p>;</span> i++<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>c</span> <span class=o>=</span> substr<span class=o>(</span><span class=nv>$0</span>, i, 1<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>ltr</span> <span class=o>=</span> index<span class=o>(</span>LETTERS, c<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span>ltr <span class=p>&amp;</span>gt<span class=p>;</span> 0<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            ++count<span class=o>[</span>ltr<span class=o>]</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=打印相对频率>打印相对频率<a hidden class=anchor aria-hidden=true href=#打印相对频率>#</a></h3><p>当 <code>gawk</code> 脚本统计完所有的字母后，我希望它能输出每个字母的频率。毕竟，我对输入中各个字母的个数没有兴趣，我更关心它们的 <em>相对频率</em>。</p><p>我将先统计字母 “a” 的个数，然后把它和剩余 “b” 到 “z” 字母的个数比较：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>END <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>min</span> <span class=o>=</span> count<span class=o>[</span>1<span class=o>]</span><span class=p>;</span> <span class=k>for</span> <span class=o>(</span><span class=nv>ltr</span> <span class=o>=</span> 2<span class=p>;</span> ltr &lt;<span class=o>=</span> 26<span class=p>;</span> ltr++<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span>count<span class=o>[</span>ltr<span class=o>]</span> &lt; min<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>min</span> <span class=o>=</span> count<span class=o>[</span>ltr<span class=o>]</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>在循环的最后，变量 <code>min</code> 会等于最少的出现次数，我可以把它为基准，为字母的个数设定一个参照值，然后计算打印出每个字母的相对频率。比如，如果出现次数最少的字母是 “q”，那么 <code>min</code> 就会等于 “q” 的出现次数。</p><p>接下来，我会遍历每个字母，打印出它和它的相对频率。我通过把每个字母的个数都除以 <code>min</code> 的方式来计算出它的相对频率，这意味着出现次数最少的字母的相对频率是 1。如果另一个字母出现的次数恰好是最少次数的两倍，那么这个字母的相对频率就是 2。我只关心整数，所以 2.1 和 2.9 对我来说是一样的（都是 2）。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>END <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>min</span> <span class=o>=</span> count<span class=o>[</span>1<span class=o>]</span><span class=p>;</span> <span class=k>for</span> <span class=o>(</span><span class=nv>ltr</span> <span class=o>=</span> 2<span class=p>;</span> ltr &lt;<span class=o>=</span> 26<span class=p>;</span> ltr++<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span>count<span class=o>[</span>ltr<span class=o>]</span> &lt; min<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>min</span> <span class=o>=</span> count<span class=o>[</span>ltr<span class=o>]</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=nv>ltr</span> <span class=o>=</span> 1<span class=p>;</span> ltr &lt;<span class=o>=</span> 26<span class=p>;</span> ltr++<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        print substr<span class=o>(</span>LETTERS, ltr, 1<span class=o>)</span>, int<span class=o>(</span>count<span class=o>[</span>ltr<span class=o>]</span> / min<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=最后的完整程序>最后的完整程序<a hidden class=anchor aria-hidden=true href=#最后的完整程序>#</a></h3><p>现在，我已经有了一个能够统计输入中各个字母的相对频率的 <code>gawk</code> 脚本：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/usr/bin/gawk -f
</span></span></span><span class=line><span class=cl><span class=cp></span> 
</span></span><span class=line><span class=cl><span class=c1># 只统计 a-z 的字符，忽略 A-Z 和其他的字符</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>BEGIN <span class=o>{</span> <span class=nv>LETTERS</span> <span class=o>=</span> <span class=s2>&#34;abcdefghijklmnopqrstuvwxyz&#34;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>len</span> <span class=o>=</span> length<span class=o>(</span><span class=nv>$0</span><span class=o>)</span><span class=p>;</span> <span class=k>for</span> <span class=o>(</span><span class=nv>i</span> <span class=o>=</span> 1<span class=p>;</span> i &lt;<span class=o>=</span> len<span class=p>;</span> i++<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>c</span> <span class=o>=</span> substr<span class=o>(</span><span class=nv>$0</span>, i, 1<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>ltr</span> <span class=o>=</span> index<span class=o>(</span>LETTERS, c<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span>ltr &lt; 0<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            ++count<span class=o>[</span>ltr<span class=o>]</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1># 打印每个字符的相对频率</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>END <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>min</span> <span class=o>=</span> count<span class=o>[</span>1<span class=o>]</span><span class=p>;</span> <span class=k>for</span> <span class=o>(</span><span class=nv>ltr</span> <span class=o>=</span> 2<span class=p>;</span> ltr &lt;<span class=o>=</span> 26<span class=p>;</span> ltr++<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span>count<span class=o>[</span>ltr<span class=o>]</span> &lt; min<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>min</span> <span class=o>=</span> count<span class=o>[</span>ltr<span class=o>]</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=nv>ltr</span> <span class=o>=</span> 1<span class=p>;</span> ltr &lt;<span class=o>=</span> 26<span class=p>;</span> ltr++<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        print substr<span class=o>(</span>LETTERS, ltr, 1<span class=o>)</span>, int<span class=o>(</span>count<span class=o>[</span>ltr<span class=o>]</span> / min<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>我将把这段程序保存到名为 <code>letter-freq.awk</code> 的文件中，这样一来，我就可以在命令行中更方便地使用它。</p><p>如果你愿意的话，你也可以使用 <code>chmod +x</code> 命令把这个文件设为可独立执行。第一行中的 <code>#!/usr/bin/gawk -f</code> 表示 Linux 会使用 <code>/usr/bin/gawk</code> 把这个文件当作一个脚本来运行。由于 <code>gawk</code> 命令行使用 <code>-f</code> 来指定它要运行的脚本文件名，你需要在末尾加上 <code>-f</code>。如此一来，当你在 shell 中执行 <code>letter-freq.awk</code>，它会被解释为 <code>/usr/bin/gawk -f letter-freq.awk</code>。</p><p>接下来我将用几个简单的输入来测试这个脚本。比如，如果我给我的 <code>gawk</code> 脚本输入整个字母表，每个字母的相对频率都应该是 1：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ <span class=nb>echo</span> abcdefghijklmnopqrstuvwxyz <span class=p>|</span> gawk -f letter-freq.awk
</span></span><span class=line><span class=cl>a <span class=m>1</span>
</span></span><span class=line><span class=cl>b <span class=m>1</span>
</span></span><span class=line><span class=cl>c <span class=m>1</span>
</span></span><span class=line><span class=cl>d <span class=m>1</span>
</span></span><span class=line><span class=cl>e <span class=m>1</span>
</span></span><span class=line><span class=cl>f <span class=m>1</span>
</span></span><span class=line><span class=cl>g <span class=m>1</span>
</span></span><span class=line><span class=cl>h <span class=m>1</span>
</span></span><span class=line><span class=cl>i <span class=m>1</span>
</span></span><span class=line><span class=cl>j <span class=m>1</span>
</span></span><span class=line><span class=cl>k <span class=m>1</span>
</span></span><span class=line><span class=cl>l <span class=m>1</span>
</span></span><span class=line><span class=cl>m <span class=m>1</span>
</span></span><span class=line><span class=cl>n <span class=m>1</span>
</span></span><span class=line><span class=cl>o <span class=m>1</span>
</span></span><span class=line><span class=cl>p <span class=m>1</span>
</span></span><span class=line><span class=cl>q <span class=m>1</span>
</span></span><span class=line><span class=cl>r <span class=m>1</span>
</span></span><span class=line><span class=cl>s <span class=m>1</span>
</span></span><span class=line><span class=cl>t <span class=m>1</span>
</span></span><span class=line><span class=cl>u <span class=m>1</span>
</span></span><span class=line><span class=cl>v <span class=m>1</span>
</span></span><span class=line><span class=cl>w <span class=m>1</span>
</span></span><span class=line><span class=cl>x <span class=m>1</span>
</span></span><span class=line><span class=cl>y <span class=m>1</span>
</span></span><span class=line><span class=cl>z <span class=m>1</span>
</span></span></code></pre></div><p>还是使用上述例子，只不过这次我在输入中添加了一个字母 “e”，此时的输出结果中，“e” 的相对频率会是 2，而其他字母的相对频率仍然会是 1：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ <span class=nb>echo</span> abcdeefghijklmnopqrstuvwxyz <span class=p>|</span> gawk -f letter-freq.awk
</span></span><span class=line><span class=cl>a <span class=m>1</span>
</span></span><span class=line><span class=cl>b <span class=m>1</span>
</span></span><span class=line><span class=cl>c <span class=m>1</span>
</span></span><span class=line><span class=cl>d <span class=m>1</span>
</span></span><span class=line><span class=cl>e <span class=m>2</span>
</span></span><span class=line><span class=cl>f <span class=m>1</span>
</span></span><span class=line><span class=cl>g <span class=m>1</span>
</span></span><span class=line><span class=cl>h <span class=m>1</span>
</span></span><span class=line><span class=cl>i <span class=m>1</span>
</span></span><span class=line><span class=cl>j <span class=m>1</span>
</span></span><span class=line><span class=cl>k <span class=m>1</span>
</span></span><span class=line><span class=cl>l <span class=m>1</span>
</span></span><span class=line><span class=cl>m <span class=m>1</span>
</span></span><span class=line><span class=cl>n <span class=m>1</span>
</span></span><span class=line><span class=cl>o <span class=m>1</span>
</span></span><span class=line><span class=cl>p <span class=m>1</span>
</span></span><span class=line><span class=cl>q <span class=m>1</span>
</span></span><span class=line><span class=cl>r <span class=m>1</span>
</span></span><span class=line><span class=cl>s <span class=m>1</span>
</span></span><span class=line><span class=cl>t <span class=m>1</span>
</span></span><span class=line><span class=cl>u <span class=m>1</span>
</span></span><span class=line><span class=cl>v <span class=m>1</span>
</span></span><span class=line><span class=cl>w <span class=m>1</span>
</span></span><span class=line><span class=cl>x <span class=m>1</span>
</span></span><span class=line><span class=cl>y <span class=m>1</span>
</span></span><span class=line><span class=cl>z <span class=m>1</span>
</span></span></code></pre></div><p>现在我可以跨出最大的一步了！我将使用 <code>grep</code> 命令和 <code>/usr/share/dict/words</code> 文件，统计所有仅由小写字母组成的单词中，各个字母的相对使用频率：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ grep  <span class=s1>&#39;^[a-z]*$&#39;</span> /usr/share/dict/words <span class=p>|</span> gawk -f letter-freq.awk
</span></span><span class=line><span class=cl>a <span class=m>53</span>
</span></span><span class=line><span class=cl>b <span class=m>12</span>
</span></span><span class=line><span class=cl>c <span class=m>28</span>
</span></span><span class=line><span class=cl>d <span class=m>21</span>
</span></span><span class=line><span class=cl>e <span class=m>72</span>
</span></span><span class=line><span class=cl>f <span class=m>7</span>
</span></span><span class=line><span class=cl>g <span class=m>15</span>
</span></span><span class=line><span class=cl>h <span class=m>17</span>
</span></span><span class=line><span class=cl>i <span class=m>58</span>
</span></span><span class=line><span class=cl>j <span class=m>1</span>
</span></span><span class=line><span class=cl>k <span class=m>5</span>
</span></span><span class=line><span class=cl>l <span class=m>36</span>
</span></span><span class=line><span class=cl>m <span class=m>19</span>
</span></span><span class=line><span class=cl>n <span class=m>47</span>
</span></span><span class=line><span class=cl>o <span class=m>47</span>
</span></span><span class=line><span class=cl>p <span class=m>21</span>
</span></span><span class=line><span class=cl>q <span class=m>1</span>
</span></span><span class=line><span class=cl>r <span class=m>46</span>
</span></span><span class=line><span class=cl>s <span class=m>48</span>
</span></span><span class=line><span class=cl>t <span class=m>44</span>
</span></span><span class=line><span class=cl>u <span class=m>25</span>
</span></span><span class=line><span class=cl>v <span class=m>6</span>
</span></span><span class=line><span class=cl>w <span class=m>4</span>
</span></span><span class=line><span class=cl>x <span class=m>1</span>
</span></span><span class=line><span class=cl>y <span class=m>13</span>
</span></span><span class=line><span class=cl>z <span class=m>2</span>
</span></span></code></pre></div><p>在 <code>/usr/share/dict/words</code> 文件的所有小写单词中，字母 “j”、“q” 和 “x” 出现的相对频率最低，字母 “z” 也使用得很少。不出意料，字母 “e” 是使用频率最高的。</p><hr><blockquote><p>转载须知：本文遵循 <a href=https://creativecommons.org/licenses/by-sa/4.0/deed.zh target=_blank rel="noopener noreferrer">CC BY-SA 4.0 许可协议</a><br>链接：<a href=https://lkxed.github.io/posts/gawk-letter-game/ target=_blank rel="noopener noreferrer">https://lkxed.github.io/posts/gawk-letter-game/</a><br>作者：<a href=https://opensource.com/users/jim-hall target=_blank rel="noopener noreferrer">Jim Hall</a>
/ 译者：<a href=https://github.com/lkxed/ target=_blank rel="noopener noreferrer">六开箱</a><br>原文：<a href=https://opensource.com/article/21/4/gawk-letter-game target=_blank rel="noopener noreferrer">Use awk to calculate letter frequency</a><br>首发：<a href=https://linux.cn/article-14375-1.html target=_blank rel="noopener noreferrer">使用 awk 统计字母频率</a>
@ <a href=https://linux.cn/ target=_blank rel="noopener noreferrer">Linux 中国</a></p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://lkxed.github.io/tags/%E8%AF%91%E6%96%87/>译文</a></li><li><a href=https://lkxed.github.io/tags/%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/>开源软件</a></li><li><a href=https://lkxed.github.io/tags/awk/>awk</a></li><li><a href=https://lkxed.github.io/tags/%E6%95%99%E7%A8%8B/>教程</a></li></ul><nav class=paginav><a class=prev href=https://lkxed.github.io/posts/c4c-linux-distro-revived/><span class=title>« 上一页</span><br><span>C4C Ubuntu：基督教信徒的 Linux 发行版</span></a>
<a class=next href=https://lkxed.github.io/posts/ubuntu-new-logo/><span class=title>下一页 »</span><br><span>Ubuntu 有了一个「怪怪的」新标志</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=lkxed/lkxed.github.io data-repo-id=R_kgDOHF00eA data-category=Announcements data-category-id=DIC_kwDOHF00eM4COXzh data-mapping=og:title data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><div class=social-icons><a href=https://github.com/lkxed/ target=_blank rel="noopener noreferrer me" title=GitHub><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://space.bilibili.com/88033726/ target=_blank rel="noopener noreferrer me" title=Bilibili><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" xmlns="http://www.w3.org/2000/svg"><rect x="1.3333" y="6" width="21.333" height="15.333" rx="4" ry="4"/><path d="m8 12.4v1.2"/><path d="m16 12.4v1.2"/><path d="m5.8853 2.6667L8.552 5.3334"/><path d="m18.115 2.6667-2.6667 2.6667"/></svg></a></div><span>&copy; 2022 <a href=https://lkxed.github.io/>六开箱</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/lkxed/hugo-PaperMod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="复制";function s(){e.innerText="已复制！",setTimeout(()=>{e.innerText="复制"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>