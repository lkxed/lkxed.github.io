[{"content":" 本文介绍了几种端口转发最常见的使用场景。\n 端口转发简介 端口转发就是把网络流量从一个网络监听者（称为一个“端口”）发送到另一个上，无论这两个端口是否属于同一台电脑。在这里，端口不是某个物理实体，而是一个监听网络活动的软件程序。\n当流量被定向发往到某个特定的端口，它会先到达一个路由器或是防火墙，亦或是其他的网络程序。它最终收到的响应可能会根据它想要通讯的端口来定义。比如，当你使用端口转发时，你可以捕获到发往 8080 端口的流量，然后把它转发到 80 端口。对于接收信号的原端口来说，这个新的目标端口可能和它在同一台设备上，也可能是在另一台设备上。我们在很多情况下都会用到端口转发，实现的方式也有很多。本文将介绍其中最常见的几种使用场景。\n使用路由器来进行端口转发 如果你在把服务器架设在家里，那么你通常是不需要转发端口的。你的家庭路由器（通常是你从网络服务提供商Internet Service Provider, ISP获得的 WiFi 设备）有一个内置的防火墙，它的作用是阻止外面的世界访问到你的家庭网络。通过使用端口转发，你可以允许某个指定端口的流量穿过路由器的防火墙，并发送到局域网中的某个指定的 IP 地址。\n比如说，你架设了一个 Minetest 服务 ，并想要邀请你的朋友们来试试。为了让他们能够“穿过”你的路由器，从而到达这个 Minetest 服务，你必须把路由器上的某个端口转发到托管 Minetest 服务的电脑上。Minetest 服务默认运行在 30000 端口。你可以把路由器的 30000 端口转发到你的电脑的 30000 端口上，或者你也可以随便转发到一个更简单的端口上，这样玩家们会更容易记住它。我发现，当使用 30000 端口的时候，人们时常会少数几个 0（特别是没有逗号分隔符的帮助时），所以我一般使用路由器的 1234 端口，然后把它转发到我内部的 30000 端口。\n每个制造商的路由器接口都不一样，但是不管你用的是什么牌子的路由器，方法都是相同的。首先，你需要登录到你的路由器。\n通常，路由器的 IP 地址和登录信息都会打印在路由器上，或者在是它的文档里。我有一个型号为 TP-Link GX90 的路由器，我在浏览器里访问 10.0.1.1 就可以登录它，但你的路由器可能是 192.168.0.1 或者其他的地址。\n我的 GX90 路由器把端口转发功能称为“虚拟服务器virtual servers”，它是路由器的“NAT 转发”标签下的一个功能选项。NAT 的意思是 “网络地址转换Network Address Translation”。在其他路由器中，这个功能可能直接就叫做“端口转发”，或者叫“防火墙”、“服务”等。找到正确的功能选项可能需要花费一些时间，因此，你可能需要花点时间研究下你的路由器文档。\n当你找到了路由器的端口转发设置，添加一个新规则，命名一个外部端口（在我的例子中是 1234）和一个内部端口（30000）。把外部端口转发到内部端口上，而内部端口绑定在你想要大家访问的电脑的 IP 地址上。如果你需要一些查询本机 IP 地址的帮助，你可以阅读 Archit Modi 写的 “在 Linux 上如何查询本地 IP 地址 ”。\n 图源 Seth Kenlon / CC-BY-SA 4.0  在这个例子中，访问家庭网络的 1234 端口的流量，都会被转发到了我的家庭服务器的 30000 端口上，后者的 IP 地址是 10.0.1.2。\n在继续之前，先保存这个规则。\n接下来，你需要知道你的家庭网络的公网 IP 地址是多少。你可以从 ifconfig.me 或者 icanhazip.com 上获得这个地址。你可以在浏览器中打开这两个网站的其中一个，也可以使用 curl 命令来获取到这个 IP。\n$ curl ifconfig.me 93.184.216.34 现在，你的朋友们就可以在 Minetest 客户端里输入 169.169.23.49:1234，加入你的 Minetest 服务器啦。\n使用防火墙来进行端口转发 系统管理员有时候需要转发访问服务器的流量。比如说，你可能想要接收来自 80 端口的流量，但是用户的服务却运行在 8065 端口。如果不进行端口转发的话，你的用户就不得不在输入浏览器的 URL 末尾，加上一个指定的端口号，例如 example.com:8065。大多数用户都不习惯于考虑端口的问题，所以你需要把访问网络通用的 80 端口的请求拦截下来，然后转发到你的网络应用的具体端口，这会给用户带来巨大的方便。\n你可以在服务器上使用 firewall-cmd 来转发流量，它是访问 firewalld 后台进程的前端front-end命令。\n首先，设置好你想要转发的端口和协议：\n$ sudo firewall-cmd \\  --add-forward-port \\  port=80:proto=tcp:toport=8065 为使修改永久生效，你需要加上 --runtime-to-permanent 选项：\n$ sudo firewall-cmd --runtime-to-permanent 网络转发 在网络传输中，除了端口转发外，还有其他种类的转发forwarding形式，例如 IP 转发和代理等。当你熟悉了网络信息在路由时是怎么被处理的之后，你可以试试不同的转发形式（然后使用 tcpdump 或类似的工具）来看看哪一种最好、最符合你的需求。\n  本文遵循 CC-BY-SA 4.0 国际协议 作者：Seth Kenlon / 译者：六开箱 原文：What is port forwarding? 首发：端口转发简介 @ Linux 中国  ","permalink":"/posts/what-port-forwarding/","summary":"本文介绍了几种端口转发最常见的使用场景。","title":"什么是端口转发"},{"content":" 有了 Linux，即便是新手用户，也能通过大量熟悉的应用程序获得流畅、精致的桌面体验。\n Linux 无处不在 大型强子对撞机是 由 Linux 驱动 的，国际空间站上的笔记本电脑是 运行在 Linux 上 的，Instagram 和 Nest thermostats 也是如此。最近，我们观看了 机智号Ingenuity 在火星上空飞翔，它是一个令人惊叹的无人直升机，也是 由 Linux 驱动的 ！这进一步证明了这个操作系统的灵活性和通用性。\n但是现在，真正的大新闻来了。我在这里“官宣”：Linux 也可以给父母使用！\n事情经过 大约一年前，我决定把妈妈的电脑环境迁移至 Linux。现在，一年过去了，是时候回顾和总结一下了。\n和大多数人一样，我是专属的 “妈妈的电脑管理员”。我的妈妈是一个 60 多岁的可爱老太太 —— 一个真正的甜心。她的电脑技能很基础，她的电脑使用需求也很基础：上上网，发发邮件，打打字，浏览、编辑照片，看看视频听听歌，还有就是在 Skype 或者 Signal 上和家里人或者朋友们打打电话。\n直到去年之前，妈妈一直在使用一个 Windows 笔记本电脑。电脑已经很旧了，但还不算太糟糕。于是在某一天，通过欺骗、威胁和弹出讨厌的窗口等手段，微软终于成功让她点击了那个可怕的按钮 —— “升级到 Windows 10”。\n她绝望地向我呼救。作为妈妈的电脑管理员，我的生活很快就变成了地狱。“为什么所有东西看起来都不一样了？我的应用列表跑去哪儿了？什么，这堆瓷块一样的东西变成我的应用列表了？我的电脑怎么变得这么慢？它怎么每天都要自动更新重启，而且偏偏就是在我想要用它的时候？为什么有东西（她指的是硬盘）一直嗡嗡嗡地叫？它到底一直在忙些什么啊？”\n可是我又看不到源代码，我怎么它一直在忙些什么呢？\n本来我是打算回滚这个升级的，但是 Windows 7 马上就要终止支持了，我担心会发生最坏的事情：没有了安全更新，妈妈的电脑很快就会变成数不清的僵尸网络bot networks中的一员，一天到晚地挖矿、发送垃圾邮件，以及对全国的重要设施发动恶毒的 DDOS 攻击。最后还是需要我来清理这个烂摊子 —— （而且是）每一个周末。\n大救星 Linux 来了 我决定把她的电脑环境迁移到 Linux 上，反正也没有什么可损失的。我自己在五年前就这么做了，我从未那么开心过。不如让妈妈也试试，肯定不会有什么坏处。\n当妈妈知道我要一次性解决她所有的问题时，她非常开心。但她不知道的是，她将成为一项为期一年的科学实验的关键部分，这个实验叫做：“妈妈能学会使用 Linux 吗？”\n 图源 Tomasz Waraksa / CC-BY-SA 4.0  于是，在 2020 年 2 月的某一天，我从遥远的都柏林带着一台使用七年的联想 Yoga 13 来到这里，这台电脑和妈妈那台有着相似的参数，但它的屏幕要好很多，而且只有一半的重量。我在 VirtualBox 里讨论和测试了不同的 Linux 发行版，最终选择了 Zorin OS 发行版，一个自豪的“爱尔兰造”系统。我选择它是考虑到了下面几个因素：\n 它基于我最熟悉的 Ubuntu Linux。 它和 Windows 7 很像，在精心设计的同时考虑到了 Windows 难民。 我感觉它很轻量、简单，对妈妈来说足够保守。完全没有 macOS Big Sur 上的花里胡哨！   图源 Tomasz Waraksa / CC-BY-SA 4.0  系统安装 我用自己一贯的方式安装了这个操作系统，为 /home 目录单独分了一个区，这样一来，系统重装时（尽管不大可能发生）妈妈的文件仍然能够保持安全。这是我的惯用技巧，它可以方便我安装发行版的深夜更新。\n在安装过程中，我选择了波兰语作为用户界面语言。和我一样，妈妈也是个彻头彻尾的波兰人。不必担心，Linux 看起来支持所有语言，甚至包括 克林贡语 。\n接着，根据妈妈的需求，我安装了下面这些应用：\n Skype Signal 桌面客户端  谷歌 Chrome 浏览器 Geary 邮件客户端 gThumb ，用来浏览和编辑照片 VLC ，用来播放视频和音乐 Softmaker Office，用来编辑文本和表格  注意到列表里没有杀毒软件了吗？好耶！\n一个小时后，系统和应用全部安装完成，妈妈的 Zorin OS 已准备就绪。\n 图源 Tomasz Waraksa / CC-BY-SA 4.0  设置系统 通过下面这几个步骤，我把自己设置成了妈妈的电脑管理员：\n 为我自己创建了一个管理员账户 把妈妈的账户设置为非管理员 安装了用于远程无人值守访问的 ssh 守护程序 把这台机器加入到了我的 Hamachi VPN 中：这样一来，我就可以安全地使用 ssh 连接，而不需要打开路由器上的 22 端口。Hamachi 是一个由 LogMeIn 提供的 VPN 服务。它是一个传统的 VPN，我的意思是，它的目标不是让你在另外一个国家运行 Netflix 应用，而是在互联网上为计算机之间建立一个安全的网络连接。 启动了简单防火墙（ufw）并允许 ssh 流量 安装了 AnyDesk 来远程登录到桌面  这样操作之后，我就可以通过安全的 ssh 连接访问到妈妈的笔记本电脑。我可以通过 shell 进行定期维护，而妈妈甚至不会注意到任何事情。这是因为 Linux 完成更新后通常 不需要 重新启动。真是一个奇迹啊！简直不可能的事，它是怎么做到的呢？\n 图源 Tomasz Waraksa / CC-BY-SA 4.0  妈妈能学会使用 Linux 吗 毫无疑问！\n尽管当我把新电脑展示给她看的时候，她确实有问到为什么这个新的 Windows 又看起来不一样了。我不得不解释说这个其实不是 Windows，而是 Linux，然后向她解释了为什么我们都爱 Linux。不过，她学得很快。这个经典的 Zorin OS 桌面和她用惯了的 Windows 7 十分相似。我看到她在系统里点来点去，然后很轻松地找到并且运行了她熟悉的应用程序。\n她立刻就注意到电脑启动快了很多，表现也好了很多。\n然后她开始问我什么时候会给她做电脑的定期清理，好让她电脑不会再一次变慢。我和她解释说，以她的日常使用量，不需要再做定期清理了。Linux 和 Windows 不一样，它不会自己“腐烂”的。目前来说，的确如此。她的电脑仍然像第一天那样流畅和快速。\n我时不时地会问她对新电脑感觉怎么样，她总是回答说很满意。一切都很顺利。电脑也不会莫名其妙就变得忙起来。再也不会有一些“很重要的更新”来打断她。应用菜单也总是在它该在的地方。在这个全新的环境中，她对自己常用的应用程序也感到满意。\n在这一年中，我远程登录过几次她的电脑，为的是进行常规的软件包升级。我还使用 AnyDesk 登录过两次她的桌面。一次是妈妈问我能不能帮她把 SD 卡里的照片自动导入到 ~/Pictures 目录里，如果能够放到以日期命名的目录里就更好了。当然可以，只要懂一点点的 Bash，就可以使用 gThumb 很轻松地实现这个功能。另一次，我把她经常访问的网站添加到了桌面，这样她点击桌面图标就可以访问了。\n这就是目前我作为妈妈的 Linux 管理员所做的全部事情！按照这个情况，我还可以再给 50 个妈妈当电脑管理员！\n总结 我希望我的故事能够启发你考虑迁移到 Linux。过去，我们认为 Linux 对于普通用户来说太难了。但今天，我相信事实恰恰相反。用户使用电脑越不熟练，他们就越有理由迁移到 Linux！\n有了 Linux，即便是新手用户，也能通过大量熟悉的应用程序获得流畅、精致的桌面体验。新手用户们将比在任何其他流行的计算平台上都要安全得多。并且，通过远程访问来帮助他们从未如此简单和安全！\n免责声明：本文不推广所描述的任何产品、服务或供应商。我与他们没有任何商业利益或联系。我并没有在暗示这些产品或服务是最适合你的，也不承诺你的体验会和我一样。\n本文最初发布在 Let\u0026rsquo;s Debug It 上，在获得许可后重新使用。\n  本文遵循 CC-BY-SA 4.0 国际协议 作者：Tomasz / 译者：六开箱 原文：How I helped my mom switch from Windows to Linux 首发：我是如何帮助妈妈从 Windows 切换至 Linux 的 @ Linux 中国  ","permalink":"/posts/mom-switch-linux/","summary":"有了 Linux，即便是新手用户，也能通过大量熟悉的应用程序获得流畅、精致的桌面体验。","title":"妈妈与 Linux 的周年纪念"}]